"use strict";

var _ = require("lodash");
var parse = require("parse");
var evalAround = require("eval-around");
var unparse = require("unparse");

module.exports = _.flow(parse, solve, unparse);

function solve(input) {

  var result = [];

  var indexCol = 0;
  var indexRow = 0;
  var best;
  while(indexCol < input.ncols && indexRow < input.nrows) {
    best = evalAround(input, indexRow, indexCol);
    console.error(JSON.stringify(best));
    result.push(best);
    indexRow = parseInt(best.bottom) +1;
    indexCol = parseInt(best.left);

  }

  console.error(JSON.stringify(result));
  return result;
}
